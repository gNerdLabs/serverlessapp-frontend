<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Part 2 - A place for everything and everything in its place | ServerlessApp.net</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="Part 2 - A place for everything and everything in its place" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="before we go too much further, it may be a good idea to set up a config file… to make changes easier" />
<meta property="og:description" content="before we go too much further, it may be a good idea to set up a config file… to make changes easier" />
<link rel="canonical" href="http://localhost:4000/serverless/frontend/2018/10/11/02-a-place-for-everything.html" />
<meta property="og:url" content="http://localhost:4000/serverless/frontend/2018/10/11/02-a-place-for-everything.html" />
<meta property="og:site_name" content="ServerlessApp.net" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-11T14:49:14-04:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/serverless/frontend/2018/10/11/02-a-place-for-everything.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/serverless/frontend/2018/10/11/02-a-place-for-everything.html"},"description":"before we go too much further, it may be a good idea to set up a config file… to make changes easier","headline":"Part 2 - A place for everything and everything in its place","dateModified":"2018-10-11T14:49:14-04:00","datePublished":"2018-10-11T14:49:14-04:00","@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ServerlessApp.net" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">ServerlessApp.net</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Part 2 - A place for everything and everything in its place</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-10-11T14:49:14-04:00" itemprop="datePublished">Oct 11, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>before we go too much further, it may be a good idea to set up a config file… to make changes easier</p>

<p>create a new file in your frontend directory named `config.dev.yml’  we’re going to add a bunch of custom configuration values in here.</p>

<p>we’re setting up this config for the “dev” environment so lets start using a stage value. Add this to the provider block:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stage: ${opt:stage, 'dev'}
</code></pre></div></div>

<p>if a stage is provided in the command line it will use that, it will default to dev when not provided.</p>

<p>now we need to tell serverless to load our file.</p>

<p>add the following to your main yml file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>custom: ${file(config.${self:provider.stage}.yml)}
</code></pre></div></div>

<p>I make this the first line of mine so it now looks something like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
custom: ${file(config.${self:provider.stage}.yml)}

provider:
  name: aws
  runtime: nodejs8.10
  stage: ${opt:stage, 'dev'}

service: serverlessapp-frontend

...
</code></pre></div></div>

<p>you can now see how the file import works. ${self:provider.stage} is set to <code class="highlighter-rouge">dev</code> by default so it loads config.dev.yml in as the value for the <code class="highlighter-rouge">custom</code> block.</p>

<p>(note: Scope for <code class="highlighter-rouge">self</code> gats a little odd the way I have this set up. its easiest to think of <code class="highlighter-rouge">self</code> as being at the main serverless.yml file root.)</p>

<p>so, lets set up our config now</p>

<p>add the following to your config.dev.yml:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
rev: 001
domainName: serverlessapp.net
cleanName: serverlessapp-frontend
appName: ${self:custom.cleanName}-app-rev${self:custom.rev}
runtime: nodejs8.10
profile: serverless-admin

</code></pre></div></div>
<p><code class="highlighter-rouge">rev</code> will be a somewhat arbitrary value we can use to tell what revision we are working on. Sometimes if a build or a remove fails it can leave remnantes that block us from reusing the exact app name again (at least until the system clears them out… which can take a while)  this is a habndy way to change the name of our next deploy so we dont have to wait.</p>

<p><code class="highlighter-rouge">domainName</code> should be pretty self explanatory</p>

<p><code class="highlighter-rouge">cleanName</code> is the base name for our app that all other names will be based off of, in this example we will use the vaule we previously had for <code class="highlighter-rouge">service</code> in the main yml file: serverlessapp-frontend</p>

<p>More on the note about scope from above…</p>

<p>since we are accessing these config values from within the main file as <code class="highlighter-rouge">custom</code>, we do <code class="highlighter-rouge">self:custom</code> and then whichever value we want. This is instead of what might seem more intuitive to some… ${self:cleanName} or somethin glike that.</p>

<p>so to reference our custon values we use the following: ${self:custom.cleanName} even when <code class="highlighter-rouge">custom</code> does not exist in the immediate file.</p>

<p>this allows us to create the following:</p>

<p><code class="highlighter-rouge">appName</code> comes out (in this example) as <code class="highlighter-rouge">serverlessapp-frontend-app-rev001</code></p>

<p>how this is used will be more evident later on in the tutorials</p>

<p><code class="highlighter-rouge">runtime</code> should be set to whatever you previously had in your main file. For this particular frontend application, we wont even be using this so it just needs to be set to something valid.</p>

<p><code class="highlighter-rouge">profile</code> while not strictly necessary is a way to specify which credentials you use for authenticating with aws… if you have multiple sets of credentials for different projects this comes in quite handy</p>

<p>Now that we have out config set up we can swap out the parts of our main yml that we have set up.</p>

<p>update your serverless.yml so it looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
custom: ${file(config.${self:provider.stage}.yml)}

provider:
  name: aws
  runtime: ${self:custom.runtime}
  stage: ${opt:stage, 'dev'}
  profile: ${self:custom.profile}

service: ${self:custom.appName}
</code></pre></div></div>

<p>the only addition is the <code class="highlighter-rouge">profile</code> entry.</p>

<hr />

<p>“Before, however, Lucy had been an hour in the house she had contrived a place for everything and put everything in its place.”</p>

<ul>
  <li>The Naughty Girl Won : Religious Tract Society in 1799</li>
</ul>

  </div><a class="u-url" href="/serverless/frontend/2018/10/11/02-a-place-for-everything.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Created by:</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">
            <a target="_blank" href="http://gnerd.io">gNerdLabs</a>
            </li><li><a class="u-email" href="mailto:serverlessapp@gnerd.io">serverlessapp@gnerd.io</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/gNerdLabs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">gNerdLabs</span></a></li><li><a href="https://www.twitter.com/gNerdLabs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">gNerdLabs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Written by <b>John Z Black</b> during the 10/12/18 Hackathon at <a target="_blank" href="https://praxent.com">Praxent</a></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
